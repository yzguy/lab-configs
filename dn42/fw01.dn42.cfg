set firewall all-ping 'enable'
set firewall broadcast-ping 'disable'
set firewall config-trap 'disable'
set firewall ip-src-route 'disable'
set firewall ipv6-receive-redirects 'disable'
set firewall ipv6-src-route 'disable'
set firewall log-martians 'disable'
set firewall name DN42-to-LAN default-action 'drop'
set firewall name DN42-to-LAN enable-default-log
set firewall name DN42-to-LAN rule 1 action 'accept'
set firewall name DN42-to-LAN rule 1 description 'Allow established/related'
set firewall name DN42-to-LAN rule 1 state established 'enable'
set firewall name DN42-to-LAN rule 1 state related 'enable'
set firewall name DN42-to-LAN rule 2 action 'drop'
set firewall name DN42-to-LAN rule 2 description 'Drop invalid state'
set firewall name DN42-to-LAN rule 2 state invalid 'enable'
set firewall name DN42-to-LAN rule 3 action 'accept'
set firewall name DN42-to-LAN rule 3 description 'Allow ICMP'
set firewall name DN42-to-LAN rule 3 protocol 'icmp'
set firewall name DN42-to-LOCAL default-action 'drop'
set firewall name DN42-to-LOCAL enable-default-log
set firewall name DN42-to-LOCAL rule 1 action 'accept'
set firewall name DN42-to-LOCAL rule 1 description 'Allow established/related'
set firewall name DN42-to-LOCAL rule 1 state established 'enable'
set firewall name DN42-to-LOCAL rule 1 state related 'enable'
set firewall name DN42-to-LOCAL rule 2 action 'drop'
set firewall name DN42-to-LOCAL rule 2 description 'Drop invalid state'
set firewall name DN42-to-LOCAL rule 2 state invalid 'enable'
set firewall name DN42-to-LOCAL rule 3 action 'accept'
set firewall name DN42-to-LOCAL rule 3 description 'Allow ICMP'
set firewall name DN42-to-LOCAL rule 3 protocol 'icmp'
set firewall name DN42-to-LOCAL rule 10 action 'accept'
set firewall name DN42-to-LOCAL rule 10 description 'Allow BGP'
set firewall name DN42-to-LOCAL rule 10 destination port '179'
set firewall name DN42-to-LOCAL rule 10 protocol 'tcp'
set firewall name DN42-to-WAN default-action 'drop'
set firewall name DN42-to-WAN enable-default-log
set firewall name DN42-to-WAN rule 1 action 'accept'
set firewall name DN42-to-WAN rule 1 description 'Allow established/related'
set firewall name DN42-to-WAN rule 1 state established 'enable'
set firewall name DN42-to-WAN rule 1 state related 'enable'
set firewall name DN42-to-WAN rule 2 action 'drop'
set firewall name DN42-to-WAN rule 2 description 'Drop invalid state'
set firewall name DN42-to-WAN rule 2 state invalid 'enable'
set firewall name LAN-to-DN42 default-action 'drop'
set firewall name LAN-to-DN42 enable-default-log
set firewall name LAN-to-DN42 rule 10 action 'accept'
set firewall name LAN-to-DN42 rule 10 description 'Allow All'
set firewall name LAN-to-LOCAL default-action 'drop'
set firewall name LAN-to-LOCAL enable-default-log
set firewall name LAN-to-LOCAL rule 10 action 'accept'
set firewall name LAN-to-LOCAL rule 10 description 'Allow All'
set firewall name LAN-to-WAN default-action 'drop'
set firewall name LAN-to-WAN enable-default-log
set firewall name LAN-to-WAN rule 10 action 'accept'
set firewall name LAN-to-WAN rule 10 description 'Allow All'
set firewall name LOCAL-to-DN42 default-action 'drop'
set firewall name LOCAL-to-DN42 enable-default-log
set firewall name LOCAL-to-DN42 rule 10 action 'accept'
set firewall name LOCAL-to-DN42 rule 10 description 'Allow All'
set firewall name LOCAL-to-LAN default-action 'drop'
set firewall name LOCAL-to-LAN enable-default-log
set firewall name LOCAL-to-LAN rule 10 action 'accept'
set firewall name LOCAL-to-LAN rule 10 description 'Allow All'
set firewall name LOCAL-to-WAN default-action 'drop'
set firewall name LOCAL-to-WAN enable-default-log
set firewall name LOCAL-to-WAN rule 10 action 'accept'
set firewall name LOCAL-to-WAN rule 10 description 'Allow All'
set firewall name WAN-to-DN42 default-action 'drop'
set firewall name WAN-to-DN42 enable-default-log
set firewall name WAN-to-DN42 rule 1 action 'accept'
set firewall name WAN-to-DN42 rule 1 description 'Allow established/related'
set firewall name WAN-to-DN42 rule 1 state established 'enable'
set firewall name WAN-to-DN42 rule 1 state related 'enable'
set firewall name WAN-to-DN42 rule 2 action 'drop'
set firewall name WAN-to-DN42 rule 2 description 'Drop invalid state'
set firewall name WAN-to-DN42 rule 2 state invalid 'enable'
set firewall name WAN-to-LAN default-action 'drop'
set firewall name WAN-to-LAN enable-default-log
set firewall name WAN-to-LAN rule 1 action 'accept'
set firewall name WAN-to-LAN rule 1 description 'Allow established/related'
set firewall name WAN-to-LAN rule 1 state established 'enable'
set firewall name WAN-to-LAN rule 1 state related 'enable'
set firewall name WAN-to-LAN rule 2 action 'drop'
set firewall name WAN-to-LAN rule 2 description 'Drop invalid state'
set firewall name WAN-to-LAN rule 2 state invalid 'enable'
set firewall name WAN-to-LOCAL default-action 'drop'
set firewall name WAN-to-LOCAL enable-default-log
set firewall name WAN-to-LOCAL rule 1 action 'accept'
set firewall name WAN-to-LOCAL rule 1 description 'Allow established/related'
set firewall name WAN-to-LOCAL rule 1 state established 'enable'
set firewall name WAN-to-LOCAL rule 1 state related 'enable'
set firewall name WAN-to-LOCAL rule 2 action 'drop'
set firewall name WAN-to-LOCAL rule 2 description 'Drop invalid state'
set firewall name WAN-to-LOCAL rule 2 state invalid 'enable'
set firewall name WAN-to-LOCAL rule 10 action 'accept'
set firewall name WAN-to-LOCAL rule 10 description 'Allow All'
set firewall receive-redirects 'disable'
set firewall send-redirects 'enable'
set firewall source-validation 'disable'
set firewall syn-cookies 'enable'
set firewall twa-hazards-protection 'disable'
set firewall zone DN42 default-action 'drop'
set firewall zone DN42 from LAN firewall name 'LAN-to-DN42'
set firewall zone DN42 from LOCAL firewall name 'LOCAL-to-DN42'
set firewall zone DN42 interface 'wg1'
set firewall zone DN42 interface 'wg2'
set firewall zone DN42 interface 'wg3'
set firewall zone DN42 interface 'wg4'
set firewall zone LAN default-action 'drop'
set firewall zone LAN from DN42 firewall name 'DN42-to-LAN'
set firewall zone LAN from LOCAL firewall name 'LOCAL-to-LAN'
set firewall zone LAN from WAN firewall name 'WAN-to-LAN'
set firewall zone LAN interface 'eth1'
set firewall zone LOCAL default-action 'drop'
set firewall zone LOCAL from DN42 firewall name 'DN42-to-LOCAL'
set firewall zone LOCAL from LAN firewall name 'LAN-to-LOCAL'
set firewall zone LOCAL from WAN firewall name 'WAN-to-LOCAL'
set firewall zone LOCAL local-zone
set firewall zone WAN default-action 'drop'
set firewall zone WAN from LAN firewall name 'LAN-to-WAN'
set firewall zone WAN from LOCAL firewall name 'LOCAL-to-WAN'
set firewall zone WAN interface 'eth0'
set interfaces ethernet eth0 address '192.168.224.254/24'
set interfaces ethernet eth1 address '172.23.109.65/27'
set interfaces ethernet eth1 address 'fd23:5a57:7294::1/48'
set interfaces loopback lo
set interfaces wireguard wg1 address '192.168.219.173/32'
set interfaces wireguard wg1 description 'Kioubit'
set interfaces wireguard wg1 mtu '1420'
set interfaces wireguard wg1 peer Kioubit address '47.87.173.98'
set interfaces wireguard wg1 peer Kioubit allowed-ips '0.0.0.0/0'
set interfaces wireguard wg1 peer Kioubit persistent-keepalive '15'
set interfaces wireguard wg1 peer Kioubit port '21669'
set interfaces wireguard wg1 peer Kioubit public-key '6Cylr9h1xFduAO+5nyXhFI1XJ0+Sw9jCpCDvcqErF1s='
set interfaces wireguard wg1 private-key 'eOcUlRM2gkOQIBXMm0K2DZJuRYRlGsn4b0CSbeKhCVM='
set interfaces wireguard wg2 address '10.10.221.2/32'
set interfaces wireguard wg2 description 'Tech9'
set interfaces wireguard wg2 mtu '1420'
set interfaces wireguard wg2 peer Tech9 address '45.76.26.51'
set interfaces wireguard wg2 peer Tech9 allowed-ips '0.0.0.0/0'
set interfaces wireguard wg2 peer Tech9 persistent-keepalive '15'
set interfaces wireguard wg2 peer Tech9 port '54259'
set interfaces wireguard wg2 peer Tech9 public-key '0kb8ffMcbx8oXZ3Ii5khOuCzmRqM2Cy0IslmrWtRGSk='
set interfaces wireguard wg2 private-key 'eOcUlRM2gkOQIBXMm0K2DZJuRYRlGsn4b0CSbeKhCVM='
set interfaces wireguard wg3 address '10.10.221.3/32'
set interfaces wireguard wg3 description 'Lutoma'
set interfaces wireguard wg3 mtu '1420'
set interfaces wireguard wg3 peer Lutoma address '23.95.146.112'
set interfaces wireguard wg3 peer Lutoma allowed-ips '0.0.0.0/0'
set interfaces wireguard wg3 peer Lutoma persistent-keepalive '15'
set interfaces wireguard wg3 peer Lutoma port '42419'
set interfaces wireguard wg3 peer Lutoma public-key 'FTvJU/9X4Pj7zsr/fh60SoL81s3qNvKVwGxwkbKwBA8='
set interfaces wireguard wg3 private-key 'eOcUlRM2gkOQIBXMm0K2DZJuRYRlGsn4b0CSbeKhCVM='
set interfaces wireguard wg4 address '10.10.221.4/32'
set interfaces wireguard wg4 description 'Liki'
set interfaces wireguard wg4 mtu '1420'
set interfaces wireguard wg4 peer Liki address '174.137.51.245'
set interfaces wireguard wg4 peer Liki allowed-ips '0.0.0.0/0'
set interfaces wireguard wg4 peer Liki persistent-keepalive '15'
set interfaces wireguard wg4 peer Liki port '42425'
set interfaces wireguard wg4 peer Liki public-key 'iaon+XHEQMlw2cvWC78bp+wZCgg7OXknKrcYepeIEmY='
set interfaces wireguard wg4 private-key 'eOcUlRM2gkOQIBXMm0K2DZJuRYRlGsn4b0CSbeKhCVM='
set nat source rule 10 outbound-interface 'eth0'
set nat source rule 10 source address '0.0.0.0/0'
set nat source rule 10 translation address 'masquerade'
set policy prefix-list AS4242421669 rule 10 action 'permit'
set policy prefix-list AS4242421669 rule 10 prefix '172.23.109.64/27'
set policy route-map DN42-EXPORT rule 10 action 'permit'
set policy route-map DN42-EXPORT rule 10 match ip address prefix-list 'AS4242421669'
set policy route-map DN42-PREF rule 10 action 'permit'
set policy route-map DN42-PREF rule 10 set local-preference '1000'
set policy route-map NO-BGP-EXPORT rule 10 action 'deny'
set policy route-map NO-BGP-IMPORT rule 10 action 'deny'
set protocols bgp address-family ipv4-unicast maximum-paths ebgp '16'
set protocols bgp address-family ipv4-unicast network 172.23.109.64/27
set protocols bgp neighbor 172.20.16.139 address-family ipv4-unicast route-map export 'DN42-EXPORT'
set protocols bgp neighbor 172.20.16.139 address-family ipv4-unicast soft-reconfiguration inbound
set protocols bgp neighbor 172.20.16.139 description 'Tech9'
set protocols bgp neighbor 172.20.16.139 ebgp-multihop '255'
set protocols bgp neighbor 172.20.16.139 remote-as '4242421588'
set protocols bgp neighbor 172.20.16.139 solo
set protocols bgp neighbor 172.20.16.139 update-source '172.23.109.65'
set protocols bgp neighbor 172.20.53.98 address-family ipv4-unicast route-map export 'DN42-EXPORT'
set protocols bgp neighbor 172.20.53.98 address-family ipv4-unicast soft-reconfiguration inbound
set protocols bgp neighbor 172.20.53.98 description 'Kioubit'
set protocols bgp neighbor 172.20.53.98 ebgp-multihop '255'
set protocols bgp neighbor 172.20.53.98 remote-as '4242423914'
set protocols bgp neighbor 172.20.53.98 solo
set protocols bgp neighbor 172.20.53.98 update-source '172.23.109.65'
set protocols bgp neighbor 172.21.77.35 address-family ipv4-unicast route-map export 'DN42-EXPORT'
set protocols bgp neighbor 172.21.77.35 address-family ipv4-unicast soft-reconfiguration inbound
set protocols bgp neighbor 172.21.77.35 description 'Liki'
set protocols bgp neighbor 172.21.77.35 ebgp-multihop '255'
set protocols bgp neighbor 172.21.77.35 remote-as '4242420927'
set protocols bgp neighbor 172.21.77.35 solo
set protocols bgp neighbor 172.21.77.35 update-source '172.23.109.65'
set protocols bgp neighbor 172.22.119.10 address-family ipv4-unicast route-map export 'DN42-EXPORT'
set protocols bgp neighbor 172.22.119.10 address-family ipv4-unicast soft-reconfiguration inbound
set protocols bgp neighbor 172.22.119.10 description 'Lutoma'
set protocols bgp neighbor 172.22.119.10 ebgp-multihop '255'
set protocols bgp neighbor 172.22.119.10 remote-as '64719'
set protocols bgp neighbor 172.22.119.10 solo
set protocols bgp neighbor 172.22.119.10 update-source '172.23.109.65'
set protocols bgp parameters graceful-restart
set protocols bgp parameters log-neighbor-changes
set protocols bgp parameters router-id '172.23.109.65'
set protocols bgp system-as '4242421669'
set protocols static route 0.0.0.0/0 next-hop 192.168.224.1
set protocols static route 172.20.16.139/32 interface wg2
set protocols static route 172.20.53.98/32 interface wg1
set protocols static route 172.21.77.35/32 interface wg4
set protocols static route 172.22.119.10/32 interface wg3
set service dhcp-server shared-network-name LAN authoritative
set service dhcp-server shared-network-name LAN domain-name 'dn42.zguy.io'
set service dhcp-server shared-network-name LAN domain-search 'dn42.yzguy.io'
set service dhcp-server shared-network-name LAN name-server '172.23.109.65'
set service dhcp-server shared-network-name LAN subnet 172.23.109.64/27 default-router '172.23.109.65'
set service dhcp-server shared-network-name LAN subnet 172.23.109.64/27 range DHCP start '172.23.109.90'
set service dhcp-server shared-network-name LAN subnet 172.23.109.64/27 range DHCP stop '172.23.109.94'
set service dns forwarding allow-from '172.23.109.64/27'
set service dns forwarding listen-address '172.23.109.65'
set service dns forwarding listen-address 'fd23:5a57:7294::1'
set service dns forwarding name-server 172.20.0.53
set service dns forwarding source-address '172.23.109.65'
set service dns forwarding source-address 'fd23:5a57:7294::1'
set service ntp allow-client address '0.0.0.0/0'
set service ntp allow-client address '::/0'
set service ntp server time1.vyos.net
set service ntp server time2.vyos.net
set service ntp server time3.vyos.net
set service ssh listen-address '192.168.224.254'
set system config-management commit-revisions '100'
set system conntrack modules ftp
set system conntrack modules h323
set system conntrack modules nfs
set system conntrack modules pptp
set system conntrack modules sip
set system conntrack modules sqlnet
set system conntrack modules tftp
set system console device ttyS0 speed '115200'
set system domain-name 'dn42.yzguy.net'
set system domain-search domain 'yzguy.net'
set system domain-search domain 'lab.yzguy.net'
set system host-name 'fw01.dn42'
set system login user yzguy authentication encrypted-password '$6$h32bw7DC$Tvxc2DPycOW710rwK9AJ11tGUFCQnvvnQDQ/BnIV6O.AMAYiwdDholvoyAjM/D9Yh4Q14Uem2pBJjE53TdIjg/'
set system login user yzguy authentication plaintext-password ''
set system login user yzguy authentication public-keys yzguy key 'AAAAC3NzaC1lZDI1NTE5AAAAIJENTfxvqB3LQLu97T5QtfpKJjDr4Wu+GoQ3EUff2pr6'
set system login user yzguy authentication public-keys yzguy type 'ssh-ed25519'
set system name-server '192.168.0.53'
set system syslog global facility all level 'info'
set system syslog global facility local7 level 'debug'
